webpackJsonp([4],{"5cGk":function(e,s){},hjWA:function(e,s,r){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var t=r("BUS2"),a=r.n(t),o=r("gyMJ"),i=r("iPXC"),u={data:function(){var e=this;return{isShowAddUserAccountDialog:!1,userSignInFrom:{customerEmail:"",customerName:"",customerTrueName:"",customerSex:"1",customerTel:"",customerAddr:"",customerPwd:"",customerPwdConFirm:"",customerAvatar:"public/upload/img/userAvatar/default_user_avatar.jpg"},userSignInFromRules:{customerEmail:[{required:!0,message:"请输入注册邮箱",trigger:"blur"},{pattern:/^[\w\-\.]+\@[\w]+\.[\w]{2,4}$/,message:"请输入正确的邮箱",trigger:"blur"}],customerName:[{required:!0,message:"请输入昵称",trigger:"blur"}],customerTrueName:[{required:!0,message:"请输入姓名",trigger:"blur"}],customerTel:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1(3|4|5|7|8)\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],customerAddr:[{required:!0,message:"请输入城市地址",trigger:"blur"}],customerPwd:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/[A-Za-z].*[0-9]|[0-9].*[A-Za-z][\W_]{8,}/,message:"密码格式错误  大于8位,必须同时包含数字和字母",trigger:"blur"}],customerPwdConFirm:[{required:!0,message:"请确认新密码",trigger:"blur"},{validator:function(s,r,t){r!==e.userSignInFrom.customerPwd?t(new Error("两次输入密码不一致!")):t()},trigger:"blur"},{pattern:/[A-Za-z].*[0-9]|[0-9].*[A-Za-z][\W_]{8,}/,message:"密码格式错误  大于8位,必须同时包含数字和字母",trigger:"blur"}]},userForm:{username:"",password:""},userRules:{username:[{required:!0,message:"请输入账号",trigger:"blur"},{pattern:/^[\w\-\.]+\@[\w]+\.[\w]{2,4}$/,message:"请输入正确的邮箱的账号",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{pattern:/[A-Za-z].*[0-9]|[0-9].*[A-Za-z][\W_]{8,}/,message:"密码格式错误  大于8位,必须同时包含数字和字母",trigger:"blur"}]}}},mounted:function(){},methods:{submitLogin:function(e){var s=this;this.$refs[e].validate(function(e){if(!e)return console.log("验证不通过"),!1;var r=s.$loading({lock:!0,text:"正在登陆中",background:"rgba(0, 0, 0, 0.2)"});o.E({username:s.userForm.username,password:a()(s.userForm.password)}).then(function(e){if(0===e.data.code){if("0"===e.data.data.me.CustomerStatus)return s.$message.error("登录失败，此账号已被禁用"),void r.close();s.$message.success(e.data.message),r.close(),console.log(e.data),i.a.set("user_me",e.data.data.me),s.$router.push("/shop/home")}else s.$message.error(e.data.message),r.close()}).catch(function(){s.$message.error("登陆失败"),r.close()})})},addUserAccount:function(e){var s=this;this.$refs[e].validate(function(r){if(!r)return console.log("验证不通过"),!1;var t=s.$loading({lock:!0,text:"正在注册中",background:"rgba(0, 0, 0, 0.2)"});s.userSignInFrom.customerPwd=a()(s.userSignInFrom.customerPwd),o.F(s.userSignInFrom).then(function(r){0===r.data.code?(s.closeAddAccountDialog(e),s.$message.success(r.data.message),t.close()):(s.refsPwd(),s.$message.error(r.data.message),t.close())}).catch(function(e){s.refsPwd(),console.error(e),s.$message.error("注册失败, 请重试"),t.close()})})},closeAddAccountDialog:function(e){this.isShowAddUserAccountDialog=!1,this.userSignInFrom.customerAvatar="public/upload/img/userAvatar/default_user_avatar.jpg",this.$refs[e].resetFields()},refsPwd:function(){this.userSignInFrom.customerPwd="",this.userSignInFrom.customerPwdConFirm=""},handleAvatarSuccess:function(e,s){0===e.code?(this.$message.success("上传头像成功"),this.userSignInFrom.customerAvatar=e.data.Filepath):this.$message.error("上传头像失败")},uploadActive:function(e,s){console.log(e),console.log(s)},beforeAvatarUpload:function(e){var s="image/jpeg"===e.type||"image/png"===e.type,r=e.size/1024/1024<2;return s||this.$message.error("上传头像图片只能是 JPG 或者 PNG 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),s&&r},uploadsError:function(e,s,r){this.$message.error("上传头像失败, 请重试")}},components:{}},l={render:function(){var e=this,s=e.$createElement,r=e._self._c||s;return r("div",{staticClass:"login"},[e._m(0),e._v(" "),r("div",{staticClass:"w"},[r("div",{staticClass:"login-box"},[r("div",{staticClass:"left-bg"}),e._v(" "),r("div",{staticClass:"right-from"},[r("p",{staticClass:"from-title text-24-R"},[e._v("登录")]),e._v(" "),r("div",{staticClass:"login-from"},[r("el-form",{ref:"userForm",attrs:{model:e.userForm,rules:e.userRules,"label-position":"top","hide-required-asterisk":""}},[r("div",{staticClass:"from-item text-14-M"},[r("el-form-item",{attrs:{label:"账号",prop:"username"}},[r("div",{staticClass:"from-item-input"},[r("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:e.userForm.username,callback:function(s){e.$set(e.userForm,"username",s)},expression:"userForm.username"}})],1)])],1),e._v(" "),r("div",{staticClass:"from-item text-14-M"},[r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("div",{staticClass:"from-item-input"},[r("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.userForm.password,callback:function(s){e.$set(e.userForm,"password",s)},expression:"userForm.password"}})],1)])],1)])],1),e._v(" "),r("div",{staticClass:"login-btn text-16-M",on:{click:function(s){e.submitLogin("userForm")}}},[e._v("\n          登 录\n        ")]),e._v(" "),r("div",{staticClass:"sign-pwd"},[r("p",{on:{click:function(s){e.isShowAddUserAccountDialog=!0}}},[e._v("账号注册")]),e._v(" "),r("p",[e._v("|")]),e._v(" "),r("p",[e._v("忘记密码")])])])])]),e._v(" "),r("el-dialog",{attrs:{"custom-class":"my-el-dialog",visible:e.isShowAddUserAccountDialog,width:"420px",top:"120px"},on:{"update:visible":function(s){e.isShowAddUserAccountDialog=s}}},[r("div",{staticClass:"handle-title text-16-M"},[e._v("\n      注册账号\n    ")]),e._v(" "),r("div",{staticClass:"add-account-content add-account-from"},[r("el-form",{ref:"addAccountFrom",attrs:{model:e.userSignInFrom,rules:e.userSignInFromRules,"label-position":"left","label-width":"100px","hide-required-asterisk":""}},[r("div",{staticClass:"from-item"},[r("el-form-item",{attrs:{label:"昵称",prop:"customerName"}},[r("div",{staticClass:"item-input"},[r("el-input",{attrs:{placeholder:"请输入昵称"},model:{value:e.userSignInFrom.customerName,callback:function(s){e.$set(e.userSignInFrom,"customerName",s)},expression:"userSignInFrom.customerName"}})],1)])],1),e._v(" "),r("div",{staticClass:"from-item"},[r("el-form-item",{attrs:{label:"邮箱账号",prop:"customerEmail"}},[r("div",{staticClass:"item-input"},[r("el-input",{attrs:{placeholder:"请输入邮箱为账号"},model:{value:e.userSignInFrom.customerEmail,callback:function(s){e.$set(e.userSignInFrom,"customerEmail",s)},expression:"userSignInFrom.customerEmail"}})],1)])],1),e._v(" "),r("div",{staticClass:"from-item"},[r("el-form-item",{attrs:{label:"姓名",prop:"customerTrueName"}},[r("div",{staticClass:"item-input"},[r("el-input",{attrs:{placeholder:"请输入真实姓名"},model:{value:e.userSignInFrom.customerTrueName,callback:function(s){e.$set(e.userSignInFrom,"customerTrueName",s)},expression:"userSignInFrom.customerTrueName"}})],1)])],1),e._v(" "),r("div",{staticClass:"from-item"},[r("el-form-item",{attrs:{label:"性别"}},[r("div",{staticClass:"item-input"},[r("el-radio",{attrs:{label:"1"},model:{value:e.userSignInFrom.customerSex,callback:function(s){e.$set(e.userSignInFrom,"customerSex",s)},expression:"userSignInFrom.customerSex"}},[e._v("男")]),e._v(" "),r("el-radio",{attrs:{label:"2"},model:{value:e.userSignInFrom.customerSex,callback:function(s){e.$set(e.userSignInFrom,"customerSex",s)},expression:"userSignInFrom.customerSex"}},[e._v("女")])],1)])],1),e._v(" "),r("div",{staticClass:"from-item"},[r("el-form-item",{attrs:{label:"手机号",prop:"customerTel"}},[r("div",{staticClass:"item-input"},[r("el-input",{attrs:{placeholder:"请输入手机号"},model:{value:e.userSignInFrom.customerTel,callback:function(s){e.$set(e.userSignInFrom,"customerTel",s)},expression:"userSignInFrom.customerTel"}})],1)])],1),e._v(" "),r("div",{staticClass:"from-item"},[r("el-form-item",{attrs:{label:"城市",prop:"customerAddr"}},[r("div",{staticClass:"item-input"},[r("el-input",{attrs:{placeholder:"请输入所在城市"},model:{value:e.userSignInFrom.customerAddr,callback:function(s){e.$set(e.userSignInFrom,"customerAddr",s)},expression:"userSignInFrom.customerAddr"}})],1)])],1),e._v(" "),r("div",{staticClass:"from-item"},[r("el-form-item",{attrs:{label:"密码",prop:"customerPwd"}},[r("div",{staticClass:"item-input"},[r("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.userSignInFrom.customerPwd,callback:function(s){e.$set(e.userSignInFrom,"customerPwd",s)},expression:"userSignInFrom.customerPwd"}})],1)])],1),e._v(" "),r("div",{staticClass:"from-item"},[r("el-form-item",{attrs:{label:"确认密码",prop:"customerPwdConFirm"}},[r("div",{staticClass:"item-input"},[r("el-input",{attrs:{type:"password",placeholder:"请确认密码"},model:{value:e.userSignInFrom.customerPwdConFirm,callback:function(s){e.$set(e.userSignInFrom,"customerPwdConFirm",s)},expression:"userSignInFrom.customerPwdConFirm"}})],1)])],1),e._v(" "),r("div",{staticClass:"from-item"},[r("el-form-item",{attrs:{label:"上传头像"}},[r("div",{staticClass:"item-input img-bg"},[r("el-upload",{ref:"uploadsAvatar",staticClass:"avatar-uploader",attrs:{action:"http://localhost:3000/api/admin/upload",data:{uploadDir:"userAvatar"},"show-file-list":!1,"on-success":e.handleAvatarSuccess,"on-error":e.uploadsError,"on-change":e.uploadActive,"before-upload":e.beforeAvatarUpload}},[e.userSignInFrom.customerAvatar?r("img",{staticClass:"avatar",attrs:{src:"http://localhost:3000/"+e.userSignInFrom.customerAvatar}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1)])],1)])],1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(s){e.closeAddAccountDialog("addAccountFrom")}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(s){e.addUserAccount("addAccountFrom")}}},[e._v("确 定")])],1)])],1)},staticRenderFns:[function(){var e=this.$createElement,s=this._self._c||e;return s("div",{staticClass:"shop-w"},[s("div",{staticClass:"title-header"},[s("img",{attrs:{width:"150",src:"/static/img/logo-black.png",alt:""}}),this._v(" "),s("h1",{staticClass:"text-24-R"},[this._v("密林的书店")])])])}]};var n=r("VU/8")(u,l,!1,function(e){r("5cGk"),r("tjB2")},"data-v-7d02c503",null);s.default=n.exports},tjB2:function(e,s){}});
//# sourceMappingURL=4.937db6e41dbcf0b1e852.js.map